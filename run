#!/usr/bin/env bash

no_inventory () {
    echo >&2 "You must specify the workstation type (personal or work)"
    exit 1
}

[ "$#" -eq 1 ] || no_inventory
[ -f "$1" ] || no_inventory

# Change to dir of script.
cd "${0%/*}"

git pull
git submodule update --init --recursive

if [[ `uname` == 'Linux' ]]; then
    playbook="linux.yml"
else
    playbook="macos.yml"
fi
if sudo -n true 2>/dev/null; then
    ansible-playbook -i $1 $playbook
else
    ansible-playbook -i $1 $playbook --ask-sudo-pass
fi
